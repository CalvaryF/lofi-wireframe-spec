# Border collapse stress test
# Testing various nesting and edge cases

frames:
  # Test 1: Simple sibling collapse in column layout
  - Frame:
      id: "Test 1: Column siblings"
      size: [600, 300]
      layout: column
      children:
        - Box:
            outline: thin
            padding: 16
            children:
              - Text: { content: "Box A", style: body }
        - Box:
            outline: thin
            padding: 16
            children:
              - Text:
                  { content: "Box B (should collapse top with A)", style: body }
        - Box:
            outline: thin
            padding: 16
            children:
              - Text:
                  { content: "Box C (should collapse top with B)", style: body }

  # Test 2: Simple sibling collapse in row layout
  - Frame:
      id: "Test 2: Row siblings"
      size: [600, 150]
      layout: row
      children:
        - Box:
            outline: thin
            padding: 16
            children:
              - Text: { content: "A", style: body }
        - Box:
            outline: thin
            padding: 16
            children:
              - Text: { content: "B", style: body }
        - Box:
            outline: thin
            padding: 16
            children:
              - Text: { content: "C", style: body }

  # Test 3: Parent-child collapse - child touches all edges
  - Frame:
      id: "Test 3: Parent-child all edges"
      size: [600, 200]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  grow: 1
                  padding: 16
                  children:
                    - Text:
                        {
                          content: "Inner box should collapse all edges with outer",
                          style: body,
                        }

  # Test 4: Parent with padding - no collapse
  - Frame:
      id: "Test 4: Parent padding blocks collapse"
      size: [600, 200]
      layout: column
      children:
        - Box:
            outline: thin
            padding: 16
            grow: 1
            children:
              - Box:
                  outline: thin
                  grow: 1
                  padding: 16
                  children:
                    - Text:
                        {
                          content: "Should NOT collapse (parent has padding)",
                          style: body,
                        }

  # Test 5: Nested non-outlined wrappers
  - Frame:
      id: "Test 5: Non-outlined wrappers"
      size: [600, 200]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  grow: 1
                  children:
                    - Box:
                        grow: 1
                        children:
                          - Box:
                              outline: thin
                              grow: 1
                              padding: 16
                              children:
                                - Text:
                                    {
                                      content: "Deep nested - should still collapse",
                                      style: body,
                                    }

  # Test 6: Row inside column - header + sidebar pattern
  - Frame:
      id: "Test 6: Header + Row with sidebar"
      size: [800, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Header", style: h2 }
              - Box:
                  layout: row
                  grow: 1
                  children:
                    - Box:
                        outline: thin
                        padding: 16
                        children:
                          - Text:
                              {
                                content: "Sidebar (left+top+bottom should collapse)",
                                style: body,
                              }
                    - Box:
                        grow: 1
                        padding: 16
                        children:
                          - Text:
                              {
                                content: "Main content (no outline)",
                                style: body,
                              }

  # Test 7: Sidebar on right
  - Frame:
      id: "Test 7: Header + Row with right sidebar"
      size: [800, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Header", style: h2 }
              - Box:
                  layout: row
                  grow: 1
                  children:
                    - Box:
                        grow: 1
                        padding: 16
                        children:
                          - Text:
                              {
                                content: "Main content (no outline)",
                                style: body,
                              }
                    - Box:
                        outline: thin
                        padding: 16
                        children:
                          - Text:
                              {
                                content: "Sidebar (right+top+bottom should collapse)",
                                style: body,
                              }

  # Test 8: Both sidebars
  - Frame:
      id: "Test 8: Both sidebars"
      size: [900, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Header", style: h2 }
              - Box:
                  layout: row
                  grow: 1
                  children:
                    - Box:
                        outline: thin
                        padding: 16
                        children:
                          - Text: { content: "Left", style: body }
                    - Box:
                        grow: 1
                        padding: 16
                        children:
                          - Text: { content: "Main", style: body }
                    - Box:
                        outline: thin
                        padding: 16
                        children:
                          - Text: { content: "Right", style: body }

  # Test 9: Gap prevents collapse
  - Frame:
      id: "Test 9: Gap prevents collapse"
      size: [600, 200]
      layout: column
      gap: 8
      children:
        - Box:
            outline: thin
            padding: 16
            children:
              - Text: { content: "Box A", style: body }
        - Box:
            outline: thin
            padding: 16
            children:
              - Text:
                  { content: "Box B (should NOT collapse - gap)", style: body }

  # Test 10: Mixed outlined/non-outlined siblings
  - Frame:
      id: "Test 10: Mixed siblings"
      size: [600, 300]
      layout: column
      children:
        - Box:
            outline: thin
            padding: 16
            children:
              - Text: { content: "Outlined A", style: body }
        - Box:
            padding: 16
            children:
              - Text: { content: "No outline", style: body }
        - Box:
            outline: thin
            padding: 16
            children:
              - Text:
                  {
                    content: "Outlined B (should NOT collapse - gap from non-outlined)",
                    style: body,
                  }

  # Test 11: Grid-like layout (all should collapse)
  - Frame:
      id: "Test 11: Grid layout"
      size: [600, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  layout: row
                  children:
                    - Box:
                        outline: thin
                        grow: 1
                        padding: 16
                        children:
                          - Text: { content: "1", style: h2 }
                    - Box:
                        outline: thin
                        grow: 1
                        padding: 16
                        children:
                          - Text: { content: "2", style: h2 }
              - Box:
                  layout: row
                  children:
                    - Box:
                        outline: thin
                        grow: 1
                        padding: 16
                        children:
                          - Text: { content: "3", style: h2 }
                    - Box:
                        outline: thin
                        grow: 1
                        padding: 16
                        children:
                          - Text: { content: "4", style: h2 }

  # Test 12: Triple nesting with alternating outlines
  - Frame:
      id: "Test 12: Alternating outlines"
      size: [600, 300]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  grow: 1
                  padding: 8
                  children:
                    - Box:
                        outline: thin
                        grow: 1
                        children:
                          - Box:
                              grow: 1
                              padding: 8
                              children:
                                - Box:
                                    outline: thin
                                    grow: 1
                                    padding: 16
                                    children:
                                      - Text:
                                          {
                                            content: "Deepest (outer has padding, shouldn't collapse)",
                                            style: body,
                                          }

  # Test 13: Grow vertical - all children grow
  - Frame:
      id: "Test 13: All children grow"
      size: [600, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  grow: 1
                  padding: 16
                  children:
                    - Text: { content: "Row 1 (grow)", style: body }
              - Box:
                  outline: thin
                  grow: 1
                  padding: 16
                  children:
                    - Text: { content: "Row 2 (grow)", style: body }
              - Box:
                  outline: thin
                  grow: 1
                  padding: 16
                  children:
                    - Text: { content: "Row 3 (grow) - bottom should collapse", style: body }

  # Test 14: Grow vertical - only last child grows
  - Frame:
      id: "Test 14: Only last child grows"
      size: [600, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Row 1 (no grow)", style: body }
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Row 2 (no grow)", style: body }
              - Box:
                  outline: thin
                  grow: 1
                  padding: 16
                  children:
                    - Text: { content: "Row 3 (grow) - bottom should collapse", style: body }

  # Test 15: Grow vertical - no children grow
  - Frame:
      id: "Test 15: No children grow"
      size: [600, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Row 1 (no grow)", style: body }
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Row 2 (no grow)", style: body }
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Row 3 (no grow) - bottom should NOT collapse", style: body }

  # Test 16: Mixed grow in nested structure
  - Frame:
      id: "Test 16: Nested grow"
      size: [600, 400]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  outline: thin
                  padding: 16
                  children:
                    - Text: { content: "Header (no grow)", style: h2 }
              - Box:
                  grow: 1
                  layout: row
                  children:
                    - Box:
                        outline: thin
                        padding: 16
                        children:
                          - Text: { content: "Sidebar", style: body }
                    - Box:
                        outline: thin
                        grow: 1
                        padding: 16
                        children:
                          - Text: { content: "Main (grow)", style: body }

  # Test 17: Table-like rows without grow
  - Frame:
      id: "Test 17: Table rows no grow"
      size: [600, 300]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              # Header row
              - Box:
                  layout: row
                  outline: thin
                  children:
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Name", style: caption }
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Status", style: caption }
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Actions", style: caption }
              # Data rows
              - Box:
                  layout: row
                  children:
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Item 1", style: body }
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Active", style: body }
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Edit", style: body }
              - Box:
                  layout: row
                  children:
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Item 2", style: body }
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Pending", style: body }
                    - Box:
                        grow: 1
                        padding: 12
                        outline: thin
                        children:
                          - Text: { content: "Edit", style: body }

  # Test 18: Single row in growing container
  - Frame:
      id: "Test 18: Single row in grow container"
      size: [600, 300]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              - Box:
                  layout: row
                  outline: thin
                  children:
                    - Box:
                        grow: 1
                        padding: 16
                        outline: thin
                        children:
                          - Text: { content: "Cell A", style: body }
                    - Box:
                        grow: 1
                        padding: 16
                        outline: thin
                        children:
                          - Text: { content: "Cell B", style: body }

  # Test 19: Content-sized table (parent has no grow)
  # Last row should collapse bottom even without grow on child
  - Frame:
      id: "Test 19: Content-sized table"
      size: [600, 300]
      layout: column
      children:
        - Box:
            outline: thin
            grow: 1
            children:
              # Table container - NO grow, so it's content-sized
              - Box:
                  layout: column
                  outline: thin
                  children:
                    - Box:
                        layout: row
                        outline: thin
                        children:
                          - Box:
                              grow: 1
                              padding: 12
                              outline: thin
                              children:
                                - Text: { content: "Name", style: caption }
                          - Box:
                              grow: 1
                              padding: 12
                              outline: thin
                              children:
                                - Text: { content: "Status", style: caption }
                    - Box:
                        layout: row
                        outline: thin
                        children:
                          - Box:
                              grow: 1
                              padding: 12
                              outline: thin
                              children:
                                - Text: { content: "Item 1", style: body }
                          - Box:
                              grow: 1
                              padding: 12
                              outline: thin
                              children:
                                - Text: { content: "Active", style: body }
                    - Box:
                        layout: row
                        outline: thin
                        children:
                          - Box:
                              grow: 1
                              padding: 12
                              outline: thin
                              children:
                                - Text: { content: "Item 2 (last row - should collapse bottom)", style: body }
                          - Box:
                              grow: 1
                              padding: 12
                              outline: thin
                              children:
                                - Text: { content: "Pending", style: body }
